
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Policies Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="effectors.html" />
    
    
    <link rel="prev" href="enrichers.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">User Guide</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Getting Started
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../start/running.html">
            
                <a href="../start/running.html">
            
                    
                    Running Apache Brooklyn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../start/blueprints.html">
            
                <a href="../start/blueprints.html">
            
                    
                    Deploying Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../start/managing.html">
            
                <a href="../start/managing.html">
            
                    
                    Monitoring and Managing Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../start/policies.html">
            
                <a href="../start/policies.html">
            
                    
                    Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../start/concept-quickstart.html">
            
                <a href="../start/concept-quickstart.html">
            
                    
                    Concepts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../misc/download.html">
            
                <a href="../misc/download.html">
            
                    
                    Downloads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Brooklyn Concepts
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../concepts/entities.html">
            
                <a href="../concepts/entities.html">
            
                    
                    Entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../concepts/application-parent-membership.html">
            
                <a href="../concepts/application-parent-membership.html">
            
                    
                    Application, Parent and Membership
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../concepts/configuration-sensor-effectors.html">
            
                <a href="../concepts/configuration-sensor-effectors.html">
            
                    
                    Configuration, Sensors and Effectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../concepts/lifecycle-managementcontext.html">
            
                <a href="../concepts/lifecycle-managementcontext.html">
            
                    
                    Lifecycle and ManagementContext
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../concepts/dependent-configuration.html">
            
                <a href="../concepts/dependent-configuration.html">
            
                    
                    Dependent Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../concepts/location.html">
            
                <a href="../concepts/location.html">
            
                    
                    Location
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../concepts/policies.html">
            
                <a href="../concepts/policies.html">
            
                    
                    Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../concepts/execution.html">
            
                <a href="../concepts/execution.html">
            
                    
                    Execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../concepts/stop-start-restart-behaviour.html">
            
                <a href="../concepts/stop-start-restart-behaviour.html">
            
                    
                    Stop/start/restart behaviour
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    Writing Blueprints
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="creating-yaml.html">
            
                <a href="creating-yaml.html">
            
                    
                    Creating YAML Blueprint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="entity-configuration.html">
            
                <a href="entity-configuration.html">
            
                    
                    Entity Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="setting-locations.html">
            
                <a href="setting-locations.html">
            
                    
                    Setting Locations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="configuring-vms.html">
            
                <a href="configuring-vms.html">
            
                    
                    Configuring VMs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="multiple-services.html">
            
                <a href="multiple-services.html">
            
                    
                    Multiple Services and Dependency Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="custom-entities.html">
            
                <a href="custom-entities.html">
            
                    
                    Custom Entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="catalog/">
            
                <a href="catalog/">
            
                    
                    Catalog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="clusters.html">
            
                <a href="clusters.html">
            
                    
                    Clusters, Specs, and Composition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="enrichers.html">
            
                <a href="enrichers.html">
            
                    
                    Enrichers
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.10" data-path="policies.html">
            
                <a href="policies.html">
            
                    
                    Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="effectors.html">
            
                <a href="effectors.html">
            
                    
                    Effectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="clusters-and-policies.html">
            
                <a href="clusters-and-policies.html">
            
                    
                    Clusters and Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="java/">
            
                <a href="java/">
            
                    
                    Java Entities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.13.1" data-path="java/archetype.html">
            
                <a href="java/archetype.html">
            
                    
                    Creating from a Maven Archetype
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.2" data-path="java/defining-and-deploying.html">
            
                <a href="java/defining-and-deploying.html">
            
                    
                    Defining and Deploying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.3" data-path="java/bundle-dependencies.html">
            
                <a href="java/bundle-dependencies.html">
            
                    
                    Handling Bundle Dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.4" data-path="java/topology-dependencies.html">
            
                <a href="java/topology-dependencies.html">
            
                    
                    Topology, Dependencies, and Management Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.5" data-path="java/common-usage.html">
            
                <a href="java/common-usage.html">
            
                    
                    Common Classes and Entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.6" data-path="java/feeds.html">
            
                <a href="java/feeds.html">
            
                    
                    Feeds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.7" data-path="java/entity.html">
            
                <a href="java/entity.html">
            
                    
                    Writing an Entity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.8" data-path="java/entities.html">
            
                <a href="java/entities.html">
            
                    
                    Custom Entity Development
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.9" data-path="java/service-state.html">
            
                <a href="java/service-state.html">
            
                    
                    Service State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.10" data-path="java/entitlements.html">
            
                <a href="java/entitlements.html">
            
                    
                    Entitlements
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.14" data-path="winrm/">
            
                <a href="winrm/">
            
                    
                    Windows Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.15" data-path="test/">
            
                <a href="test/">
            
                    
                    Testing YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.16" data-path="ansible/">
            
                <a href="ansible/">
            
                    
                    Ansible in YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.17" data-path="chef/">
            
                <a href="chef/">
            
                    
                    Chef in YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.18" data-path="salt/">
            
                <a href="salt/">
            
                    
                    Salt in YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.19" data-path="advanced-example.html">
            
                <a href="advanced-example.html">
            
                    
                    YAML Blueprint Advanced Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.20" data-path="blueprinting-tips.html">
            
                <a href="blueprinting-tips.html">
            
                    
                    Blueprinting Tips
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.21" data-path="../blueprint/yaml-reference.md">
            
                <span>
            
                    
                    YAML Blueprint Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../locations/">
            
                <a href="../locations/">
            
                    
                    Deploying Blueprint
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../locations/">
            
                <a href="../locations/#clouds">
            
                    
                    Clouds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../locations/">
            
                <a href="../locations/#amazon-web-services-aws">
            
                    
                    Amazon Web Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../locations/">
            
                <a href="../locations/#azure-compute-arm">
            
                    
                    Azure Compute ARM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../locations/">
            
                <a href="../locations/#azure-compute-classic">
            
                    
                    Azure Compute Classic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../locations/">
            
                <a href="../locations/#apache-cloudstack">
            
                    
                    Apache CloudStack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../locations/">
            
                <a href="../locations/#google-compute-engine-gce">
            
                    
                    Google Compute Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../locations/">
            
                <a href="../locations/#ibm-softlayer">
            
                    
                    IBM Softlayer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../locations/">
            
                <a href="../locations/#openstack">
            
                    
                    OpenStack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../locations/">
            
                <a href="../locations/#named-locations">
            
                    
                    Named Locations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../locations/">
            
                <a href="../locations/#inheritance-and-named-locations">
            
                    
                    Provisioned Machine Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="../locations/">
            
                <a href="../locations/#byon">
            
                    
                    BYON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="../locations/">
            
                <a href="../locations/#ssh-keys">
            
                    
                    SSH Keys
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="../locations/">
            
                <a href="../locations/#localhost">
            
                    
                    Localhost
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="../locations/">
            
                <a href="../locations/#location-customizers">
            
                    
                    Location Customizers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.15" data-path="../locations/">
            
                <a href="../locations/#customizing-cloud-security-groups">
            
                    
                    Customizing Cloud Security Groups
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.16" data-path="../locations/">
            
                <a href="../locations/#specialized-locations">
            
                    
                    Specialized Locations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Reference Guide
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../ops/production-installation.html">
            
                <a href="../ops/production-installation.html">
            
                    
                    Production Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../ops/starting-stopping-monitoring.html">
            
                <a href="../ops/starting-stopping-monitoring.html">
            
                    
                    Starting, Stopping and Monitoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../ops/server-cli-reference.html">
            
                <a href="../ops/server-cli-reference.html">
            
                    
                    Server CLI Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../ops/cli/">
            
                <a href="../ops/cli/">
            
                    
                    Client CLI Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" >
            
                <span>
            
                    
                    GUI Guide
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.1" data-path="../ops/gui/running.html">
            
                <a href="../ops/gui/running.html">
            
                    
                    Launching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.2" data-path="../ops/gui/blueprints.html">
            
                <a href="../ops/gui/blueprints.html">
            
                    
                    Deploying Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.3" data-path="../ops/gui/managing.html">
            
                <a href="../ops/gui/managing.html">
            
                    
                    Monitoring and Managing Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.4" data-path="../ops/gui/policies.html">
            
                <a href="../ops/gui/policies.html">
            
                    
                    Using Policies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../ops/rest.html">
            
                <a href="../ops/rest.html">
            
                    
                    REST API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../ops/configuration/">
            
                <a href="../ops/configuration/">
            
                    
                    Brooklyn Configuration and Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="../ops/persistence/">
            
                <a href="../ops/persistence/">
            
                    
                    Persistence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="../ops/high-availability/">
            
                <a href="../ops/high-availability/">
            
                    
                    High Availability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.9.1" data-path="../ops/high-availability/high-availability-supplemental.html">
            
                <a href="../ops/high-availability/high-availability-supplemental.html">
            
                    
                    Configuring HA - an example
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="../ops/logging.html">
            
                <a href="../ops/logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="../ops/externalized-configuration.html">
            
                <a href="../ops/externalized-configuration.html">
            
                    
                    Externalized Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="../ops/requirements.html">
            
                <a href="../ops/requirements.html">
            
                    
                    Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13" data-path="../ops/upgrade.html">
            
                <a href="../ops/upgrade.html">
            
                    
                    Upgrade
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.14" data-path="../ops/security-guidelines.html">
            
                <a href="../ops/security-guidelines.html">
            
                    
                    Security Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.15" data-path="../ops/troubleshooting/">
            
                <a href="../ops/troubleshooting/">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../misc/">
            
                <a href="../misc/">
            
                    
                    Other 0.12.0 Resources
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Developer Guide</li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <a target="_blank" href="https://brooklyn.apache.org/developers/code/">
            
                    
                    Get the Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../dev/env/maven-build.html">
            
                <a href="../dev/env/maven-build.html">
            
                    
                    Maven Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../dev/env/ide/">
            
                <a href="../dev/env/ide/">
            
                    
                    IDE Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../dev/code/structure.html">
            
                <a href="../dev/code/structure.html">
            
                    
                    Code Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../dev/code/tests.html">
            
                <a href="../dev/code/tests.html">
            
                    
                    Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../dev/code/licensing.html">
            
                <a href="../dev/code/licensing.html">
            
                    
                    License Considerations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../dev/tips/">
            
                <a href="../dev/tips/">
            
                    
                    Miscellaneous Tips and Tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../dev/tips/logging.html">
            
                <a href="../dev/tips/logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../dev/tips/debugging-remote-brooklyn.html">
            
                <a href="../dev/tips/debugging-remote-brooklyn.html">
            
                    
                    Brooklyn Remote Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" >
            
                <a target="_blank" href="http://github.com/apache/brooklyn">
            
                    
                    GitHub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" >
            
                <a target="_blank" href="https://brooklyn.apache.org/v/latest/misc/javadoc">
            
                    
                    Javadoc
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <a target="_blank" href="https://brooklyn.apache.org/meta/versions.html">
            
                    
                    Versions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                <a target="_blank" href="https://brooklyn.apache.org/documentation/other-docs.html">
            
                    
                    Other Resources
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Policies</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>Policies perform the active management enabled by Brooklyn.
They can subscribe to entity sensors and be triggered by them (or they can run periodically,
or be triggered by external systems).</p>
<p>Policies can add subscriptions to sensors on any entity. Normally a policy will subscribe to sensors on
either its associated entity, that entity&apos;s children and/or to the members of a &quot;group&quot; entity.</p>
<p>Common uses of a policy include the following:</p>
<ul>
<li>perform calculations,</li>
<li>look up other values,</li>
<li>invoke effectors  (management policies) or,</li>
<li>cause the entity associated with the policy to emit sensor values (enricher policies).</li>
</ul>
<p>Entities can have zero or more <code>Policy</code> instances attached to them.</p>
<h2 id="off-the-shelf-policies">Off-the-Shelf Policies</h2>
<p>Policies are highly reusable as their inputs, thresholds and targets are customizable.
Config key details for each policy can be found in the Catalog in the Brooklyn UI.</p>
<h3 id="hadr-and-scaling-policies">HA/DR and Scaling Policies</h3>
<h4 id="autoscaler-policy">AutoScaler Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.autoscaling.AutoScalerPolicy</li>
</ul>
<p>Increases or decreases the size of a Resizable entity based on an aggregate sensor value, the current size of the entity, and customized high/low watermarks.</p>
<p>An AutoScaler policy can take any sensor as a metric, have its watermarks tuned live, and target any resizable entity - be it an application server managing how many instances it handles, or a tier managing global capacity.</p>
<p>e.g. if the average request per second across a cluster of Tomcat servers goes over the high watermark, it will resize the cluster to bring the average back to within the watermarks.</p>
<pre><code class="lang-yaml">brooklyn.policies:
<span class="hljs-attr">- type:</span> org.apache.brooklyn.policy.autoscaling.AutoScalerPolicy
  brooklyn.config:
<span class="hljs-attr">    metric:</span> webapp.reqs.perSec.perNode
<span class="hljs-attr">    metricUpperBound:</span> <span class="hljs-number">3</span>
<span class="hljs-attr">    metricLowerBound:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">    resizeUpStabilizationDelay:</span> <span class="hljs-number">2</span>s
<span class="hljs-attr">    resizeDownStabilizationDelay:</span> <span class="hljs-number">1</span>m
<span class="hljs-attr">    maxPoolSize:</span> <span class="hljs-number">3</span>
</code></pre>
<h4 id="servicerestarter-policy">ServiceRestarter Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.ha.ServiceRestarter</li>
</ul>
<p>Attaches to a SoftwareProcess or to anything Startable which emits <code>ha.entityFailed</code> on failure
(or other configurable sensor), and invokes <code>restart</code> on that failure. 
If there is a subsequent failure within a configurable time interval or if the restart fails, 
this gives up and emits <code>ha.entityFailed.restart</code> for other policies to act upon or for manual intervention.</p>
<pre><code class="lang-yaml">brooklyn.policies:
<span class="hljs-attr">- type:</span> org.apache.brooklyn.policy.ha.ServiceRestarter
  brooklyn.config:
<span class="hljs-attr">    failOnRecurringFailuresInThisDuration:</span> <span class="hljs-number">5</span>m
</code></pre>
<p>Typically this is used in conjunction with the FailureDetector enricher to emit the trigger sensor.
The <a href="../start/policies.html">introduction to policies</a> shows a worked 
example of these working together.</p>
<h4 id="servicereplacer-policy">ServiceReplacer Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.ha.ServiceReplacer</li>
</ul>
<p>The ServiceReplacer attaches to a DynamicCluster and replaces a failed member in response to 
<code>ha.entityFailed</code> (or other configurable sensor).<br>The <a href="../start/policies.html">introduction to policies</a> shows a worked 
example of this policy in use.</p>
<h4 id="sshmachinefailuredetector-policy">SshMachineFailureDetector Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.ha.SshMachineFailureDetector</li>
</ul>
<p>The SshMachineFailureDetector is an HA policy for monitoring an SshMachine, emitting an event if the connection is lost/restored.</p>
<h4 id="connectionfailuredetector-policy">ConnectionFailureDetector Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.ha.ConnectionFailureDetector</li>
</ul>
<p>The ConnectionFailureDetector is an HA policy for monitoring an http connection, emitting an event if the connection is lost/restored.</p>
<h3 id="optimization-policies">Optimization Policies</h3>
<h4 id="periodiceffector-policy">PeriodicEffector Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.action.PeriodicEffectorPolicy</li>
</ul>
<p>The <code>PeriodicEffectorPolicy</code> calls an effector with a set of arguments at a specified time and date. The policy monitors the 
sensor configured by <code>start.sensor</code> and will only start when this is set to <code>true</code>. The default sensor checked is <code>service.isUp</code>, 
so that the policy will not execute the effector until the entity is started. The following example calls a <code>resize</code> effector 
to resize a cluster up to 10 members at 8am and then down to 1 member at 6pm.</p>
<pre><code>- type: org.apache.brooklyn.policy.action.PeriodicEffectorPolicy
  brooklyn.config:
    effector: resize
    args:
      desiredSize: 10
    period: 1 day
    time: 08:00:00
- type: org.apache.brooklyn.policy.action.PeriodicEffectorPolicy
  brooklyn.config:
    effector: resize
    args:
      desiredSize: 1
    period: 1 day
    time: 18:00:00
</code></pre><h4 id="scheduledeffector-policy">ScheduledEffector Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.action.ScheduledEffectorPolicy</li>
</ul>
<p>The <code>ScheduledEffectorPolicy</code> calls an effector at a specific time. The policy monitors the sensor configured by <code>start.sensor</code> 
and will only execute the effector at the specified time if this is set to <code>true</code>.</p>
<p>There are two modes of operation, one based solely on policy configuration where the effector will execute at the time set 
using the <code>time</code> key or after the duration set using the <code>wait</code> key, or by monitoring sensors. The policy monitors the 
<code>scheduler.invoke.now</code> sensor and will execute the effector immediately when its value changes to <code>true</code>. 
When the <code>scheduler.invoke.at</code> sensor changes, it will set a time in the future when the effector should be executed.</p>
<p>The following example calls a <code>backup</code> effector every night at midnight.</p>
<pre><code>- type: org.apache.brooklyn.policy.action.ScheduledEffectorPolicy
  brooklyn.config:
    effector: backup
    time: 00:00:00
</code></pre><h4 id="followthesun-policy">FollowTheSun Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.followthesun.FollowTheSunPolicy</li>
</ul>
<p>The FollowTheSunPolicy is for moving work around to follow the demand.  The work can be any Movable entity.  This currently available in yaml blueprints.</p>
<h4 id="loadbalancing-policy">LoadBalancing Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.loadbalancing.LoadBalancingPolicy</li>
</ul>
<p>The LoadBalancingPolicy is attached to a pool of &quot;containers&quot;, each of which can host one or more migratable &quot;items&quot;.  The policy monitors the workrates of the items and effects migrations in an attempt to ensure that the containers are all sufficiently utilized without any of them being overloaded.</p>
<h3 id="lifecycle-and-user-management-policies">Lifecycle and User Management Policies</h3>
<h4 id="stopafterduration-policy">StopAfterDuration Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.action.StopAfterDurationPolicy</li>
</ul>
<p>The StopAfterDurationPolicy can be used to limit the lifetime of an entity.  After a configure time period expires the entity will be stopped.</p>
<h4 id="conditionalsuspend-policy">ConditionalSuspend Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.ha.ConditionalSuspendPolicy</li>
</ul>
<p>The ConditionalSuspendPolicy will suspend and resume a target policy based on configured suspend and resume sensors.</p>
<h4 id="createuser-policy">CreateUser Policy</h4>
<ul>
<li>org.apache.brooklyn.policy.jclouds.os.CreateUserPolicy</li>
</ul>
<p>The CreateUserPolicy Attaches to an Entity and monitors for the addition of a location to that entity, the policy then adds a new user to the VM with a randomly generated password, with the SSH connection details set on the entity as the createuser.vm.user.credentials sensor.</p>
<h4 id="advertisewinrmlogin-policy">AdvertiseWinRMLogin Policy</h4>
<ul>
<li>org.apache.brooklyn.location.winrm.WinRmMachineLocation</li>
</ul>
<p>This is similar to the CreateUserPolicy.  It will monitor the addition of WinRmMachineLocation to an entity and then create a sensor advertising the administrative user&apos;s credentials.</p>
<h2 id="writing-a-policy">Writing a Policy</h2>
<h3 id="your-first-policy">Your First Policy</h3>
<p>Policies perform the active management enabled by Brooklyn.
Each policy instance is associated with an entity,
and at runtime it will typically subscribe to sensors on that entity or children,
performing some computation and optionally actions when a subscribed sensor event occurs.
This action might be invoking an effector or emitting a new sensor,
depending the desired behavior is.</p>
<p>Writing a policy is straightforward.
Simply extend <a href="https://brooklyn.apache.org/v/latest/misc/javadoc/org/apache/brooklyn/core/policy/AbstractPolicy.html" target="_blank"><code>AbstractPolicy</code></a>,
overriding the <a href="https://brooklyn.apache.org/v/latest/misc/javadoc/org/apache/brooklyn/core/objs/AbstractEntityAdjunct.html#setEntity-org.apache.brooklyn.api.entity.EntityLocal-" target="_blank"><code>setEntity</code></a> method to supply any subscriptions desired:</p>
<pre><code class="lang-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setEntity</span><span class="hljs-params">(EntityLocal entity)</span> </span>{
        <span class="hljs-keyword">super</span>.setEntity(entity)
        subscribe(entity, TARGET_SENSOR, <span class="hljs-keyword">this</span>)
    }
</code></pre>
<p>and supply the computation and/or activity desired whenever that event occurs:</p>
<pre><code class="lang-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(SensorEvent&lt;Integer&gt; event)</span> </span>{
        <span class="hljs-keyword">int</span> val = event.getValue()
        <span class="hljs-keyword">if</span> (val % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>)
            entity.sayYoureOdd();
    }
</code></pre>
<p>You&apos;ll want to do more complicated things, no doubt,
like access other entities, perform multiple subscriptions,
and emit other sensors -- and you can.
See the best practices below and source code for some commonly used policies and enrichers,
such as <code>AutoScalerPolicy</code> and <code>RollingMeanEnricher</code>.</p>
<p>One rule of thumb, to close on:
try to keep policies simple, and compose them together at runtime;
for instance, if a complex computation triggers an action,
define one <strong>enricher</strong> policy to aggregate other sensors and emit a new sensor,
then write a second policy to perform that action.</p>
<h3 id="best-practice">Best Practice</h3>
<p>The following recommendations should be considered when designing policies:</p>
<h4 id="management-should-take-place-as-low-as-possible-in-the-hierarchy">Management should take place as &quot;low&quot; as possible in the hierarchy</h4>
<ul>
<li><p>place management responsibility in policies at the entity, as much as possible ideally management should take run as a policy on the relevant entity</p>
</li>
<li><p>place escalated management responsibility at the parent entity. Where this is impractical, perhaps because two aspects of an entity are best handled in two different places, ensure that the separation of responsibilities is documented and there is a group membership relationship between secondary/aspect managers.</p>
</li>
</ul>
<h4 id="policies-should-be-small-and-composable">Policies should be small and composable</h4>
<p>e.g. one policy which takes a sensor and emits a different, enriched sensor, and a second policy which responds to the enriched sensor of the first     (e.g. a policy detects a process is maxed out and emits a TOO_HOT sensor; a second policy responds to this by scaling up the VM where it is running, requesting more CPU)</p>
<h4 id="where-a-policy-cannot-resolve-a-situation-at-an-entity-the-issue-should-be-escalated-to-a-manager-with-a-compatible-policy">Where a policy cannot resolve a situation at an entity, the issue should be escalated to a manager with a compatible policy.</h4>
<p>Typically escalation will go to the entity parent, and then cascade up.
e.g. if the earlier VM CPU cannot be increased, the TOO_HOT event may go to the parent, a cluster entity, which attempts to balance. If the cluster cannot balance, then to another policy which attempts to scale out the cluster, and should the cluster be unable to scale, to a third policy which emits TOO_HOT for the cluster.</p>
<h4 id="management-escalation-should-be-carefully-designed-so-that-policies-are-not-incompatible">Management escalation should be carefully designed so that policies are not incompatible</h4>
<p>Order policies carefully, and mark sensors as &quot;handled&quot; (or potentially &quot;swallow&quot; them locally), so that subsequent policies and parent entities do not take superfluous (or contradictory) corrective action.</p>
<h3 id="implementation-classes">Implementation Classes</h3>
<p>Extend <a href="https://brooklyn.apache.org/v/latest/misc/javadoc/org/apache/brooklyn/core/policy/AbstractPolicy.html" target="_blank"><code>AbstractPolicy</code></a>, or override an existing policy.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Policies","layout":"website-normal","level":"1.5.10","depth":2,"next":{"title":"Effectors","level":"1.5.11","depth":2,"path":"blueprints/effectors.md","ref":"blueprints/effectors.md","articles":[]},"previous":{"title":"Enrichers","level":"1.5.9","depth":2,"path":"blueprints/enrichers.md","ref":"blueprints/enrichers.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include-highlight","theme-api"],"root":"./guide","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"include-highlight":{"extensionToLanguage":{"yml":"yaml","yaml":"yaml","bom":"yaml","java":"java"}},"theme-api":{"languages":[{"lang":"vagrant","name":"Vagrant","default":true},{"lang":"centos","name":"CentOS / RHEL 7"},{"lang":"ubuntu","name":"Ubuntu / Debian"},{"lang":"osx","name":"OSX / Linux"},{"lang":"windows","name":"Windows"}],"split":false,"theme":"light"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"path":{"style":"/style","guide":"/guide","website":"/website","v":"/v"},"pdf-default-versioned-url-subpath":"/v/0.11.0","brooklyn-stable-version":"0.11.0","sass":{"sass_dir":"style/css"},"markdown":"kramdown","brooklyn-version":"0.13.0-SNAPSHOT","url_root":"http://0.0.0.0:4000","root_menu_page":"/website/index.md","encoding":"utf-8","dependency_mode":"local","dependency_urls":{"bootstrap.css":"https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css","bootstrap.js":"https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js","jquery.js":"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"},"exclude":["/Gemfile*","/README.md"],"pdf-default-base-url":"http://brooklyn.apache.org","pdf-rewrite-prefixes":{"/guide":"/v/0.11.0","/website":""},"brooklyn-snapshot-git-branch":"master"},"gitbook":"*"},"file":{"path":"blueprints/policies.md","mtime":"2017-10-06T11:31:52.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-10-06T11:32:19.198Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    

    </body>
</html>

