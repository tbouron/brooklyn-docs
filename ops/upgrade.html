
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Upgrade Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="security-guidelines.html" />
    
    
    <link rel="prev" href="requirements.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">User Guide</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Getting Started
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../start/running.html">
            
                <a href="../start/running.html">
            
                    
                    Running Apache Brooklyn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../start/blueprints.html">
            
                <a href="../start/blueprints.html">
            
                    
                    Deploying Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../start/managing.html">
            
                <a href="../start/managing.html">
            
                    
                    Monitoring and Managing Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../start/policies.html">
            
                <a href="../start/policies.html">
            
                    
                    Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../start/concept-quickstart.html">
            
                <a href="../start/concept-quickstart.html">
            
                    
                    Concepts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../misc/download.html">
            
                <a href="../misc/download.html">
            
                    
                    Downloads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Brooklyn Concepts
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../concepts/entities.html">
            
                <a href="../concepts/entities.html">
            
                    
                    Entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../concepts/application-parent-membership.html">
            
                <a href="../concepts/application-parent-membership.html">
            
                    
                    Application, Parent and Membership
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../concepts/configuration-sensor-effectors.html">
            
                <a href="../concepts/configuration-sensor-effectors.html">
            
                    
                    Configuration, Sensors and Effectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../concepts/lifecycle-managementcontext.html">
            
                <a href="../concepts/lifecycle-managementcontext.html">
            
                    
                    Lifecycle and ManagementContext
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../concepts/dependent-configuration.html">
            
                <a href="../concepts/dependent-configuration.html">
            
                    
                    Dependent Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../concepts/location.html">
            
                <a href="../concepts/location.html">
            
                    
                    Location
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../concepts/policies.html">
            
                <a href="../concepts/policies.html">
            
                    
                    Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../concepts/execution.html">
            
                <a href="../concepts/execution.html">
            
                    
                    Execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../concepts/stop-start-restart-behaviour.html">
            
                <a href="../concepts/stop-start-restart-behaviour.html">
            
                    
                    Stop/start/restart behaviour
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../blueprints/">
            
                <a href="../blueprints/">
            
                    
                    Writing Blueprints
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../blueprints/creating-yaml.html">
            
                <a href="../blueprints/creating-yaml.html">
            
                    
                    Creating YAML Blueprint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../blueprints/entity-configuration.html">
            
                <a href="../blueprints/entity-configuration.html">
            
                    
                    Entity Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../blueprints/setting-locations.html">
            
                <a href="../blueprints/setting-locations.html">
            
                    
                    Setting Locations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../blueprints/configuring-vms.html">
            
                <a href="../blueprints/configuring-vms.html">
            
                    
                    Configuring VMs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../blueprints/multiple-services.html">
            
                <a href="../blueprints/multiple-services.html">
            
                    
                    Multiple Services and Dependency Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../blueprints/custom-entities.html">
            
                <a href="../blueprints/custom-entities.html">
            
                    
                    Custom Entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../blueprints/catalog/">
            
                <a href="../blueprints/catalog/">
            
                    
                    Catalog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../blueprints/clusters.html">
            
                <a href="../blueprints/clusters.html">
            
                    
                    Clusters, Specs, and Composition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../blueprints/enrichers.html">
            
                <a href="../blueprints/enrichers.html">
            
                    
                    Enrichers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="../blueprints/policies.html">
            
                <a href="../blueprints/policies.html">
            
                    
                    Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="../blueprints/effectors.html">
            
                <a href="../blueprints/effectors.html">
            
                    
                    Effectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="../blueprints/clusters-and-policies.html">
            
                <a href="../blueprints/clusters-and-policies.html">
            
                    
                    Clusters and Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="../blueprints/java/">
            
                <a href="../blueprints/java/">
            
                    
                    Java Entities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.13.1" data-path="../blueprints/java/archetype.html">
            
                <a href="../blueprints/java/archetype.html">
            
                    
                    Creating from a Maven Archetype
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.2" data-path="../blueprints/java/defining-and-deploying.html">
            
                <a href="../blueprints/java/defining-and-deploying.html">
            
                    
                    Defining and Deploying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.3" data-path="../blueprints/java/bundle-dependencies.html">
            
                <a href="../blueprints/java/bundle-dependencies.html">
            
                    
                    Handling Bundle Dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.4" data-path="../blueprints/java/topology-dependencies.html">
            
                <a href="../blueprints/java/topology-dependencies.html">
            
                    
                    Topology, Dependencies, and Management Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.5" data-path="../blueprints/java/common-usage.html">
            
                <a href="../blueprints/java/common-usage.html">
            
                    
                    Common Classes and Entities
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.6" data-path="../blueprints/java/feeds.html">
            
                <a href="../blueprints/java/feeds.html">
            
                    
                    Feeds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.7" data-path="../blueprints/java/entity.html">
            
                <a href="../blueprints/java/entity.html">
            
                    
                    Writing an Entity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.8" data-path="../blueprints/java/entities.html">
            
                <a href="../blueprints/java/entities.html">
            
                    
                    Custom Entity Development
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.9" data-path="../blueprints/java/service-state.html">
            
                <a href="../blueprints/java/service-state.html">
            
                    
                    Service State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13.10" data-path="../blueprints/java/entitlements.html">
            
                <a href="../blueprints/java/entitlements.html">
            
                    
                    Entitlements
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.14" data-path="../blueprints/winrm/">
            
                <a href="../blueprints/winrm/">
            
                    
                    Windows Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.15" data-path="../blueprints/test/">
            
                <a href="../blueprints/test/">
            
                    
                    Testing YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.16" data-path="../blueprints/ansible/">
            
                <a href="../blueprints/ansible/">
            
                    
                    Ansible in YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.17" data-path="../blueprints/chef/">
            
                <a href="../blueprints/chef/">
            
                    
                    Chef in YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.18" data-path="../blueprints/salt/">
            
                <a href="../blueprints/salt/">
            
                    
                    Salt in YAML Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.19" data-path="../blueprints/advanced-example.html">
            
                <a href="../blueprints/advanced-example.html">
            
                    
                    YAML Blueprint Advanced Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.20" data-path="../blueprints/blueprinting-tips.html">
            
                <a href="../blueprints/blueprinting-tips.html">
            
                    
                    Blueprinting Tips
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.21" data-path="../blueprint/yaml-reference.md">
            
                <span>
            
                    
                    YAML Blueprint Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../locations/">
            
                <a href="../locations/">
            
                    
                    Deploying Blueprint
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../locations/">
            
                <a href="../locations/#clouds">
            
                    
                    Clouds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../locations/">
            
                <a href="../locations/#amazon-web-services-aws">
            
                    
                    Amazon Web Services
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../locations/">
            
                <a href="../locations/#azure-compute-arm">
            
                    
                    Azure Compute ARM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../locations/">
            
                <a href="../locations/#azure-compute-classic">
            
                    
                    Azure Compute Classic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../locations/">
            
                <a href="../locations/#apache-cloudstack">
            
                    
                    Apache CloudStack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../locations/">
            
                <a href="../locations/#google-compute-engine-gce">
            
                    
                    Google Compute Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../locations/">
            
                <a href="../locations/#ibm-softlayer">
            
                    
                    IBM Softlayer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../locations/">
            
                <a href="../locations/#openstack">
            
                    
                    OpenStack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../locations/">
            
                <a href="../locations/#named-locations">
            
                    
                    Named Locations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../locations/">
            
                <a href="../locations/#inheritance-and-named-locations">
            
                    
                    Provisioned Machine Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="../locations/">
            
                <a href="../locations/#byon">
            
                    
                    BYON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="../locations/">
            
                <a href="../locations/#ssh-keys">
            
                    
                    SSH Keys
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="../locations/">
            
                <a href="../locations/#localhost">
            
                    
                    Localhost
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="../locations/">
            
                <a href="../locations/#location-customizers">
            
                    
                    Location Customizers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.15" data-path="../locations/">
            
                <a href="../locations/#customizing-cloud-security-groups">
            
                    
                    Customizing Cloud Security Groups
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.16" data-path="../locations/">
            
                <a href="../locations/#specialized-locations">
            
                    
                    Specialized Locations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    Reference Guide
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="production-installation.html">
            
                <a href="production-installation.html">
            
                    
                    Production Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="starting-stopping-monitoring.html">
            
                <a href="starting-stopping-monitoring.html">
            
                    
                    Starting, Stopping and Monitoring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="server-cli-reference.html">
            
                <a href="server-cli-reference.html">
            
                    
                    Server CLI Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="cli/">
            
                <a href="cli/">
            
                    
                    Client CLI Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" >
            
                <span>
            
                    
                    GUI Guide
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.5.1" data-path="gui/running.html">
            
                <a href="gui/running.html">
            
                    
                    Launching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.2" data-path="gui/blueprints.html">
            
                <a href="gui/blueprints.html">
            
                    
                    Deploying Blueprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.3" data-path="gui/managing.html">
            
                <a href="gui/managing.html">
            
                    
                    Monitoring and Managing Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5.4" data-path="gui/policies.html">
            
                <a href="gui/policies.html">
            
                    
                    Using Policies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="rest.html">
            
                <a href="rest.html">
            
                    
                    REST API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="configuration/">
            
                <a href="configuration/">
            
                    
                    Brooklyn Configuration and Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="persistence/">
            
                <a href="persistence/">
            
                    
                    Persistence
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="high-availability/">
            
                <a href="high-availability/">
            
                    
                    High Availability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.9.1" data-path="high-availability/high-availability-supplemental.html">
            
                <a href="high-availability/high-availability-supplemental.html">
            
                    
                    Configuring HA - an example
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="logging.html">
            
                <a href="logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="externalized-configuration.html">
            
                <a href="externalized-configuration.html">
            
                    
                    Externalized Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="requirements.html">
            
                <a href="requirements.html">
            
                    
                    Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7.13" data-path="upgrade.html">
            
                <a href="upgrade.html">
            
                    
                    Upgrade
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.14" data-path="security-guidelines.html">
            
                <a href="security-guidelines.html">
            
                    
                    Security Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.15" data-path="troubleshooting/">
            
                <a href="troubleshooting/">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../misc/">
            
                <a href="../misc/">
            
                    
                    Other 0.12.0 Resources
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Developer Guide</li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <a target="_blank" href="https://brooklyn.apache.org/developers/code/">
            
                    
                    Get the Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../dev/env/maven-build.html">
            
                <a href="../dev/env/maven-build.html">
            
                    
                    Maven Build
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../dev/env/ide/">
            
                <a href="../dev/env/ide/">
            
                    
                    IDE Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../dev/code/structure.html">
            
                <a href="../dev/code/structure.html">
            
                    
                    Code Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../dev/code/tests.html">
            
                <a href="../dev/code/tests.html">
            
                    
                    Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../dev/code/licensing.html">
            
                <a href="../dev/code/licensing.html">
            
                    
                    License Considerations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../dev/tips/">
            
                <a href="../dev/tips/">
            
                    
                    Miscellaneous Tips and Tricks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../dev/tips/logging.html">
            
                <a href="../dev/tips/logging.html">
            
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../dev/tips/debugging-remote-brooklyn.html">
            
                <a href="../dev/tips/debugging-remote-brooklyn.html">
            
                    
                    Brooklyn Remote Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" >
            
                <a target="_blank" href="http://github.com/apache/brooklyn">
            
                    
                    GitHub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" >
            
                <a target="_blank" href="https://brooklyn.apache.org/v/latest/misc/javadoc">
            
                    
                    Javadoc
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <a target="_blank" href="https://brooklyn.apache.org/meta/versions.html">
            
                    
                    Versions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                <a target="_blank" href="https://brooklyn.apache.org/documentation/other-docs.html">
            
                    
                    Other Resources
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Upgrade</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>This guide provides all necessary information to upgrade Apache Brooklyn for both the RPM/DEB and Tarball packages.</p>
<h2 id="backwards-compatibility">Backwards Compatibility</h2>
<p>Apache Brooklyn version 0.12.0 onward runs primarily inside a Karaf container. When upgrading from 0.11.0 or below,
this update changes the mechanisms for launching Brooklyn.
This will impact any custom scripting around the launching of Brooklyn, and the supplying of command line arguments.</p>
<p>Use of the <code>lib/dropins</code> and <code>lib/patch</code> folders will no longer work (because Karaf does not support that kind of classloading).
Instead, code must be built and installed as <a href="https://en.wikipedia.org/wiki/OSGi#Bundles" target="_blank">OSGi bundles</a>.</p>
<h2 id="upgrading">Upgrading</h2>
<ul>
<li><p>Use of RPM and DEB is now recommended where possible, rather than the tar.gz. This entirely replaces the previous install.</p>
</li>
<li><p>CentOS 7.x is recommended over CentOS 6.x (note: the RPM <strong>will not work</strong> on CentOS 6.x)</p>
</li>
</ul>
<h3 id="upgrade-from-apache-brooklyn-0120-onward">Upgrade from Apache Brooklyn 0.12.0 onward</h3>
<p>{::options parse_block_html=&quot;true&quot; /}</p>
<ul class="nav nav-tabs">
    <li class="active impl-1-tab"><a data-target="#impl-1, .impl-1-tab" data-toggle="tab" href="#">RPM / DEB Packages</a></li>
    <li class="impl-2-tab"><a data-target="#impl-2, .impl-2-tab" data-toggle="tab" href="#">Tarball</a></li>
</ul>

<div class="tab-content">
<div id="impl-1" class="tab-pane fade in active">

1. **Important!** Backup persisted state and custom configuration, in case you need to rollback to a previous version.

   1. By default, persisted state is located at `/var/lib/brooklyn`.
      The `persistenceDir` and `persistenceLocation` are configured in the file `/etc/brooklyn/org.apache.brooklyn.osgilauncher.cfg`.
      The persistence details will be logged in `/var/log/brooklyn/brooklyn.info.log` at startup time.

   2. Configuration files are in `/etc/brooklyn`.

2. Upgrade Apache Brooklyn:

   1. [Download](../misc/download.html) the new RPM/DEB package

   2. Upgrade Apache Brooklyn:

          # CentOS / RHEL
          sudo yum upgrade apache-brooklyn-xxxx.noarch.rpm

          # Ubuntu / Debian
          sudo dpkg -i apache-brooklyn-xxxx.all.deb

      If there are conflicts in configuration files (located in `/etc/brooklyn`), the upgrade will behave differently based 
      on the package you are using:

      * RPM: the upgrade will keep the previously installed one and save the new version, with the suffix `.rpmsave`.
        You will then need to check and manually resolve those.
      * DEB: the upgrade will ask you what to do.

3. Start Apache Brooklyn:

       # CentOS 7 / RHEL
       sudo systemctl start brooklyn
       # CentOS 6 and older
       sudo initctl start brooklyn

       # Ubuntu / Debian
       start brooklyn

   Wait for Brooklyn to be running (i.e. its web-console is responsive)

</div>

<div id="impl-2" class="tab-pane fade">

1. Stop Apache Brooklyn:

       ./bin/stop brooklyn

   If this does not stop it within a few seconds (as checked with `sudo ps aux | grep karaf`), then use `sudo kill <java_pid>`

2. **Important!** Backup persisted state and custom configuration.

   1. By default, persisted state is located at `~/.brooklyn/brooklyn-persisted-state`.
      The `persistenceDir` and `persistenceLocation` are configured in the file `./etc/org.apache.brooklyn.osgilauncher.cfg`.
      The persistence details will be logged in `./log/brooklyn.info.log` at startup time.

   2. Configuration files are in `./etc/`.
      Any changes to these configuration files will need to be re-applied after reinstalling Brooklyn.

3. Install new version of Apache Brooklyn:

   1. [Download](../misc/download.html) the new tarball zip package.

   2. Install Brooklyn:

          tar -zxf apache-brooklyn-xxxx.tar.gz
          cd apache-brooklyn-xxxx

4. Restore any changes to the configuration files (see step 2).

5. Validate that the new release works, by starting in &quot;HOT_BACKUP&quot; mode.

   1. Before starting Brooklyn, reconfigure `./etc/org.apache.brooklyn.osgilauncher.cfg` and set `highAvailabilityMode=HOT_BACKUP`.
      This way when Brooklyn is started, it will only read and validate the persisted state and will not write into it.

   2. Start Apache Brooklyn:

          ./bin/start brooklyn

   3. Check whether you have rebind ERROR messages in `./log/brooklyn.info.log`, e.g. `sudo grep -E &quot;WARN|ERROR&quot; /opt/brooklyn/log/brooklyn.debug.log`.
      If you do not have such errors you can proceed.

   4. Stop Apache Brooklyn:

          ./bin/stop brooklyn

   5. Change the `highAvailabilityMode` to the default (AUTO) by commenting it out in `./etc/org.apache.brooklyn.osgilauncher.cfg`.

6. Start Apache Brooklyn:

       ./bin/start brooklyn

   Wait for Brooklyn to be running (i.e. its web-console is responsive).

7. Update the catalog, using the br command:

   1. [Download](https://brooklyn.apache.org/download/index.html#command-line-client) the br tool.

   2. Login with br: `br login http://localhost:8081 <user> <password>`.

   3. Update the catalog: `br catalog add /opt/brooklyn/catalog/catalog.bom`.

</password></user></java_pid></div>
</div>

<h3 id="upgrade-from-apache-brooklyn-0110-and-below">Upgrade from Apache Brooklyn 0.11.0 and below</h3>
<ul class="nav nav-tabs">
    <li class="active impl-1-tab"><a data-target="#impl-1, .impl-1-tab" data-toggle="tab" href="#">RPM / DEB Packages</a></li>
    <li class="impl-2-tab"><a data-target="#impl-2, .impl-2-tab" data-toggle="tab" href="#">Tarball</a></li>
</ul>

<div class="tab-content">
<div id="impl-1" class="tab-pane fade in active">

1. Stop Apache Brooklyn:

       # CentOS 7 / RHEL
       sudo systemctl stop brooklyn
       # CentOS6 and older
       sudo initctl stop brooklyn

       # Ubuntu / Debian
       stop brooklyn

   If this does not stop it within a few seconds (as checked with `sudo ps aux | grep brooklyn`), then use `sudo kill <java_pid>`.

2. **Important!** Backup persisted state and custom configuration.

   1. By default, persisted state is located at `/opt/brooklyn/.brooklyn/`..
      The `persistenceDir` and `persistenceLocation` are configured in the file `./etc/org.apache.brooklyn.osgilauncher.cfg`.
      The persistence details will be logged in `./log/brooklyn.info.log` at startup time.

   2. Configuration files are in `./etc/`.
      Any changes to these configuration files will need to be re-applied after reinstalling Brooklyn.

3. Delete the existing Apache Brooklyn install:

   1. Remove Brooklyn package:

          # CentOS / RHEL
          sudo yum erase apache-brooklyn

          # Ubuntu / Debian
          sudo dpkg -r apache-brooklyn

    2. On CentOS 7 run `sudo systemctl daemon-reload`.

    3. Confirm that Brooklyn is definitely not running (see step 1 above).

    4. Delete the Brooklyn install directory: `sudo rm -r /opt/brooklyn` as well as the Brooklyn log directory:
       `sudo rm -r /var/log/brooklyn/`

4. Make sure you have Java 8.
   By default CentOS images come with JRE6 which is incompatible version for Brooklyn.
   If CentOS is prior to 6.8 upgrade nss: `yum -y upgrade nss`

5. Install new version of Apache Brooklyn:

   1. [Download](../misc/download.html) the new RPM/DEB package.

   2. Install Apache Brooklyn:

          # CentOS / RHEL
          sudo yum install apache-brooklyn-xxxx.noarch.rpm

          # Ubuntu / Debian
          sudo dpkg -i apache-brooklyn-xxxx.all.deb

6. Restore the persisted state and configuration.

   1. Stop the Brooklyn service:

          # CentOS 7 / RHEL 
          sudo systemctl stop brooklyn
          # CentOS 6 and older
          sudo initctl stop brooklyn

          # Ubuntu / Debian
          stop brooklyn

      Confirm that Brooklyn is no longer running (see step 1).

   2. Restore the persisted state directory into `/var/lib/brooklyn` and any changes to the configuration files (see step 2).
      Ensure owner/permissions are correct for the persisted state directory, e.g.:
      `sudo chown -r brooklyn:brooklyn /var/lib/brooklyn`

7. Validate that the new release works, by starting in &quot;HOT_BACKUP&quot; mode.

   1. Before starting Brooklyn, reconfigure `/etc/brooklyn/org.apache.brooklyn.osgilauncher.cfg` and set `highAvailabilityMode=HOT_BACKUP`.
      This way when Brooklyn is started, it will only read and validate the persisted state and will not write into it.

   2. Start Apache Brooklyn:

          # CentOS 7 / RHEL
          sudo systemctl start brooklyn
          # CentOS 6 and older
          sudo initctl start brooklyn

          # Ubuntu / Debian
          start brooklyn

   3. Check whether you have rebind ERROR messages in the Brooklyn logs, e.g. `sudo grep -E &quot;Rebind|WARN|ERROR&quot; /var/log/brooklyn/brooklyn.debug.log`.
      If you do not have such errors you can proceed.

   4. Stop Brooklyn:

          # CentOS 7 / RHEL 
          sudo systemctl stop brooklyn
          # CentOS 6 and older
          sudo initctl stop brooklyn

          # Ubuntu / Debian
          stop brooklyn

   5. Change the `highAvailabilityMode` to the default (AUTO) by commenting it out in `./etc/org.apache.brooklyn.osgilauncher.cfg`.

8. Start Apache Brooklyn:

       # CentOS 7 / RHEL
       sudo systemctl start brooklyn
       # CentOS 6 and older
       sudo initctl start brooklyn

       # Ubuntu / Debian
       start brooklyn

   Wait for Brooklyn to be running (i.e. its web-console is responsive).

9. Update the catalog, using the br command:

   1. Download the br tool (i.e. from the &quot;CLI Download&quot; link in the web-console).

   2. Login with br: `br login http://localhost:8081 <user> <password>`.

   3. Update the catalog: `br catalog add /opt/brooklyn/catalog/catalog.bom`.

</password></user></java_pid></div>

<div id="impl-2" class="tab-pane fade">

Same instructions as above.

</div>
</div>

<h2 id="rollback">Rollback</h2>
<p>This section applies only with you are using the RPM/DEB packages. To perform a rollback, please follow these instructions:</p>
<pre><code class="lang-bash"><span class="hljs-comment"># CentOS / RHEL</span>
yum downgrade apache-brooklyn.noarch

<span class="hljs-comment"># Ubuntu Debian</span>
dpkg -i apache-brooklyn-xxxx.all.deb
</code></pre>
<p><em>Note that to downgrade a DEB package is essentially installing a previous version therefore you need to <a href="../misc/download.html">download</a>
the version you want to downgrade to before hand.</em></p>
<h2 id="how-to-stop-your-service">How to stop your service</h2>
<p>On systemd: </p>
<pre><code class="lang-bash">systemctl stop brooklyn
</code></pre>
<p>On upstart: </p>
<pre><code class="lang-bash">stop brooklyn
</code></pre>
<h2 id="web-login-credentials">Web login credentials</h2>
<ul>
<li><p>User credentials should now be recorded in <a href="paths.html"><code>brooklyn.cfg</code></a>.</p>
</li>
<li><p>Brooklyn will still read them from both <a href="paths.html"><code>brooklyn.cfg</code></a> and <code>~/.brooklyn/brooklyn.properties</code>.</p>
</li>
<li><p>Configure a username/password by modifying <a href="paths.html"><code>brooklyn.cfg</code></a>. An example entry is:</p>
</li>
</ul>
<pre><code class="lang-bash">brooklyn.webconsole.security.users=admin
brooklyn.webconsole.security.user.admin.password=password2
</code></pre>
<h2 id="persistence">Persistence</h2>
<p>If you have persisted state you wish to rebind to, persistence is now configured in the following files:</p>
<ul>
<li><a href="paths.html"><code>brooklyn.cfg</code></a></li>
<li><a href="paths.html"><code>org.apache.brooklyn.osgilauncher.cfg</code></a></li>
</ul>
<p>For example, to use S3 for the persisted state, add the following to <a href="paths.html"><code>brooklyn.cfg</code></a>:</p>
<pre><code class="lang-bash">brooklyn.location.named.aws<span class="hljs-_">-s</span>3-eu-west-1:aws<span class="hljs-_">-s</span>3:eu-west-1
brooklyn.location.named.aws<span class="hljs-_">-s</span>3-eu-west-1.identity=&lt;ADD CREDS&gt;
brooklyn.location.named.aws<span class="hljs-_">-s</span>3-eu-west-1.credential=&lt;ADD CREDS&gt;
</code></pre>
<p>To continue the S3 example, for the persisted state, add the following to <a href="paths.html"><code>org.apache.brooklyn.osgilauncher.cfg</code></a>:</p>
<pre><code class="lang-bash">persistenceLocation=aws<span class="hljs-_">-s</span>3-eu-west-1
persistenceDir=&lt;ADD HERE&gt;
</code></pre>
<p>Apache Brooklyn should be stopped before this file is modified, and then restarted with the new configuration.</p>
<p><strong><em>Note that you can not store the credentials (for e.g. aws-s3-eu-west-1) in the catalog because that catalog is stored
in the persisted state. Apache Brooklyn needs to know it in order to read the persisted state at startup time.</em></strong></p>
<p>If binding to existing persisted state, an additional command is required to update the existing catalog with the Brooklyn
0.12.0 versions. Assuming Brooklyn has been installed to <a href="paths.html"><code>/opt/brooklyn</code></a> (as is done by the RPM and DEB):</p>
<pre><code class="lang-bash">    br catalog add /opt/brooklyn/catalog/catalog.bom
</code></pre>
<p>All existing custom jars previously added to lib/plugins (e.g. for Java-based entities) need to be converted to OSGi bundles,
and installed in Karaf. The use of the &quot;brooklyn.libraries&quot; section in catalog.bom files will continue to work.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Upgrade","layout":"website-normal","level":"1.7.13","depth":2,"next":{"title":"Security Guidelines","level":"1.7.14","depth":2,"path":"ops/security-guidelines.md","ref":"ops/security-guidelines.md","articles":[]},"previous":{"title":"Requirements","level":"1.7.12","depth":2,"path":"ops/requirements.md","ref":"ops/requirements.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include-highlight","theme-api"],"root":"./guide","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"include-highlight":{"extensionToLanguage":{"yml":"yaml","yaml":"yaml","bom":"yaml","java":"java"}},"theme-api":{"languages":[{"lang":"vagrant","name":"Vagrant","default":true},{"lang":"centos","name":"CentOS / RHEL 7"},{"lang":"ubuntu","name":"Ubuntu / Debian"},{"lang":"osx","name":"OSX / Linux"},{"lang":"windows","name":"Windows"}],"split":false,"theme":"light"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"path":{"style":"/style","guide":"/guide","website":"/website","v":"/v"},"pdf-default-versioned-url-subpath":"/v/0.11.0","brooklyn-stable-version":"0.11.0","sass":{"sass_dir":"style/css"},"markdown":"kramdown","brooklyn-version":"0.13.0-SNAPSHOT","url_root":"http://0.0.0.0:4000","root_menu_page":"/website/index.md","encoding":"utf-8","dependency_mode":"local","dependency_urls":{"bootstrap.css":"https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css","bootstrap.js":"https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js","jquery.js":"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"},"exclude":["/Gemfile*","/README.md"],"pdf-default-base-url":"http://brooklyn.apache.org","pdf-rewrite-prefixes":{"/guide":"/v/0.11.0","/website":""},"brooklyn-snapshot-git-branch":"master"},"gitbook":"*"},"file":{"path":"ops/upgrade.md","mtime":"2017-10-06T11:31:52.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-10-06T11:32:19.198Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    

    </body>
</html>

